generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String  @id @default(uuid())
  name      String
  email     String  @unique
  password  String
  validated Boolean @default(false)

  Company Company[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Company {
  id        String   @id @default(uuid())
  name      String
  cnpj      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  salesData SaleData[]
  Products  Products[]
  Count     Count[]
}

model SaleData {
  id            String   @id @default(uuid())
  data_extracao DateTime
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  vendas_por_dia       Json
  vendas_por_grupo     Json
  vendas_por_atendente Json

  @@unique([companyId, data_extracao])
}

model Products {
  id          String   @id @default(uuid())
  companyCnpj String
  codigo      Int
  barras      String
  descricao   String
  estoque     Decimal  @db.Decimal(10, 4)
  createdAt   DateTime @default(now())

  company Company @relation(fields: [companyCnpj], references: [cnpj], onDelete: Cascade)
}

model Count {
  id String @id @default(uuid())

  companyCnpj String
  company     Company @relation(fields: [companyCnpj], references: [cnpj], onDelete: Cascade)

  produtoId String

  codigo   Int
  contagem Decimal @db.Decimal(10, 4)

  createdAt DateTime @default(now())
}
